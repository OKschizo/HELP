(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5742],{10985:function(){},64566:function(e,t,a){"use strict";a.d(t,{AuthGuard:function(){return i}});var s=a(59533),n=a(18077),l=a(11394);function i(e){let{children:t,fallback:a}=e,{isAuthenticated:i,isLoading:o}=(0,n.a)();return o?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--hl-cyan)]"})}):i?(0,s.jsx)(s.Fragment,{children:t}):a||(0,s.jsx)(l.R,{})}},11394:function(e,t,a){"use strict";a.d(t,{R:function(){return u}});var s=a(59533),n=a(31229),l=a(3810),i=a(67975),o=a(11604),r=a(18077),c=a(28291),d=a(38985);function u(){let{address:e,isConnected:t}=(0,l.m)(),{disconnect:a}=(0,i.q)(),{isAuthenticated:u,isLoading:m,signIn:w,signOut:h}=(0,r.a)(),[f,x]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{x(!0)},[]),f)?t?u?(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-sm text-[var(--fg-muted)]",children:[null==e?void 0:e.slice(0,6),"...",null==e?void 0:e.slice(-4)]}),(0,s.jsx)(o.NL.Custom,{children:e=>{let{account:t,chain:a,openAccountModal:n,openChainModal:l,openConnectModal:i,authenticationStatus:o,mounted:r}=e,d=r&&"loading"!==o;return(0,s.jsx)("div",{...!d&&{"aria-hidden":!0,style:{opacity:0,pointerEvents:"none",userSelect:"none"}},children:d&&t&&a&&(!o||"authenticated"===o)?a.unsupported?(0,s.jsx)(c.Button,{onClick:l,type:"button",variant:"outline",children:"Wrong network"}):(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:n,className:"px-3 py-1 text-sm border border-[var(--stroke-soft)] rounded-lg hover:bg-[var(--bg-subtle)] transition-colors",children:t.displayName}),(0,s.jsx)("button",{onClick:h,disabled:m,className:"px-3 py-1 text-sm text-[var(--fg-muted)] hover:text-[var(--fg-default)] transition-colors",children:m?"Signing out...":"Sign Out"})]}):(0,s.jsx)(c.Button,{onClick:i,type:"button",children:"Connect Wallet"})})}})]}):(0,s.jsxs)(d.Z,{className:"max-w-md mx-auto text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Sign In"}),(0,s.jsxs)("p",{className:"text-[var(--fg-muted)] mb-2",children:["Wallet connected: ",null==e?void 0:e.slice(0,6),"...",null==e?void 0:e.slice(-4)]}),(0,s.jsx)("p",{className:"text-[var(--fg-muted)] mb-6",children:"Sign a message to authenticate with HELP"}),(0,s.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,s.jsx)(c.Button,{onClick:w,disabled:m,className:"min-w-[120px]",children:m?"Signing...":"Sign In"}),(0,s.jsx)("button",{onClick:()=>a(),className:"px-4 py-2 text-sm text-[var(--fg-muted)] hover:text-[var(--fg-default)] transition-colors",children:"Disconnect"})]})]}):(0,s.jsxs)(d.Z,{className:"max-w-md mx-auto text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Connect Your Wallet"}),(0,s.jsx)("p",{className:"text-[var(--fg-muted)] mb-6",children:"Connect your wallet to access HELP"}),(0,s.jsx)(o.NL.Custom,{children:e=>{let{account:t,chain:a,openAccountModal:n,openChainModal:l,openConnectModal:i,authenticationStatus:o,mounted:r}=e,d=r&&"loading"!==o;return(0,s.jsx)("div",{...!d&&{"aria-hidden":!0,style:{opacity:0,pointerEvents:"none",userSelect:"none"}},children:d&&t&&a&&(!o||"authenticated"===o)?null:(0,s.jsx)(c.Button,{onClick:i,type:"button",children:"Connect Wallet"})})}})]}):(0,s.jsxs)(d.Z,{className:"max-w-md mx-auto text-center",children:[(0,s.jsx)("div",{className:"h-8 bg-[var(--bg-subtle)] rounded animate-pulse mb-4"}),(0,s.jsx)("div",{className:"h-4 bg-[var(--bg-subtle)] rounded animate-pulse mb-6"}),(0,s.jsx)("div",{className:"h-10 bg-[var(--bg-subtle)] rounded animate-pulse"})]})}},18077:function(e,t,a){"use strict";a.d(t,{H:function(){return d},a:function(){return u}});var s=a(59533),n=a(31229),l=a(3810),i=a(95556),o=a(43051),r=a(59691);let c=(0,n.createContext)(void 0);function d(e){let{children:t}=e,{address:a,isConnected:d}=(0,l.m)(),{signMessageAsync:u}=(0,i.Q)(),[m,w]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),[g,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{p(!0)},[]),(0,n.useEffect)(()=>{x&&b()},[a,d,x]);let b=async()=>{if(!a||!d){w(!1);return}f(!0);try{let e=await fetch("/api/user");if(e.ok){let t=await e.json();w(t.address===a)}else w(!1)}catch(e){console.error("Auth check failed:",e),w(!1)}finally{f(!1)}},E=async()=>{if(!a||!d)return!1;f(!0);try{let e=await fetch("/api/siwe/nonce");if(!e.ok)throw Error("Failed to get nonce");let t=await e.text(),s=new o.SiweMessage({domain:window.location.host,address:a,statement:"Sign in with Ethereum to HELP - Hyper Ethereal Launch Platform",uri:window.location.origin,version:"1",chainId:999,nonce:t}).prepareMessage(),n=await u({message:s}),l=await fetch("/api/siwe/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,signature:n})});if(l.ok&&(await l.json()).ok){w(!0);try{let e=await r.UserDatabase.getOrCreateUser(a);y(e)}catch(e){console.error("Failed to create/get user:",e)}return!0}throw Error("Verification failed")}catch(e){return console.error("Sign in failed:",e),w(!1),!1}finally{f(!1)}},v=async()=>{f(!0);try{await fetch("/api/siwe/logout",{method:"POST"}),w(!1),y(null)}catch(e){console.error("Sign out failed:",e)}finally{f(!1)}};return(0,s.jsx)(c.Provider,{value:{address:x?a:void 0,isAuthenticated:!!x&&m,isLoading:!!x&&h,user:x?g:null,signIn:E,signOut:v},children:t})}function u(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},703:function(e,t,a){"use strict";a.d(t,{db:function(){return r}});var s=a(69584),n=a(28239),l=a(44492);let i={apiKey:l.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:l.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:l.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:l.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:l.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:l.env.NEXT_PUBLIC_FIREBASE_APP_ID},o=0===(0,s.C6)().length?(0,s.ZF)(i):(0,s.C6)()[0],r=(0,n.ad)(o);t.Z=o},59691:function(e,t,a){"use strict";a.d(t,{UserDatabase:function(){return l}});var s=a(28239),n=a(703);class l{static async getOrCreateUser(e){let t=e.toLowerCase(),a=(0,s.collection)(n.db,"users"),l=(0,s.query)(a,(0,s.where)("walletAddress","==",t)),i=await (0,s.getDocs)(l);if(!i.empty){let e=i.docs[0];return{id:e.id,...e.data()}}let o={walletAddress:t,createdAt:s.EK.now(),updatedAt:s.EK.now()};return{id:(await (0,s.ET)(a,o)).id,...o}}static async updateUserProfile(e,t){let a=(0,s.JU)(n.db,"users",e);await (0,s.r7)(a,{profile:t,updatedAt:s.EK.now()})}static async getUserCollections(e){let t=(0,s.collection)(n.db,"collections"),a=(0,s.query)(t,(0,s.where)("userId","==",e));return(await (0,s.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()}))}static async createCollection(e,t,a){let l=a.contractAddress?String(a.contractAddress).toLowerCase():void 0;if(l){let t=(0,s.collection)(n.db,"collections"),a=(0,s.query)(t,(0,s.where)("userId","==",e),(0,s.where)("contractAddress","==",l)),i=await (0,s.getDocs)(a);if(!i.empty){let e=i.docs[0];return{id:e.id,...e.data()}}}let i={...a,...l?{contractAddress:l}:{},userId:e,walletAddress:t.toLowerCase(),stats:{totalMinted:0,totalRevenue:"0",uniqueHolders:0},bannerImageUrl:"",avatarImageUrl:"",categories:[],headerImageUrl:"",thumbnailUrl:"",shareOnExplore:!1,createdAt:s.EK.now(),updatedAt:s.EK.now()},o=(0,s.collection)(n.db,"collections");return{id:(await (0,s.ET)(o,i)).id,...i}}static async updateCollection(e,t){let a=(0,s.JU)(n.db,"collections",e);await (0,s.r7)(a,{...t,updatedAt:s.EK.now()})}static async updateCollectionByContractAddress(e,t){let a=await l.findCollectionByContractAddress(e);if(!a)throw Error("Collection not found for contract address");await l.updateCollection(a.id,t)}static async findCollectionByContractAddress(e){let t=(0,s.collection)(n.db,"collections"),a=await (0,s.getDocs)((0,s.query)(t,(0,s.where)("contractAddress","==",e.toLowerCase())));if(a.empty&&(a=await (0,s.getDocs)((0,s.query)(t,(0,s.where)("contractAddress","==",e)))),a.empty)return null;let l=a.docs[0];return{id:l.id,...l.data()}}static async addAllowlistRound(e,t){let a=(0,s.JU)(n.db,"collections",e),l=(0,s.JU)((0,s.collection)(a,"allowlists"),t.id),i=(0,s.JU)((0,s.collection)(a,"allowlists"),"".concat(t.id,"-addresses")),o={id:t.id,name:t.name,root:t.root,size:t.size,priceWei:t.priceWei||"0",createdAt:s.EK.now(),updatedAt:s.EK.now()};"number"==typeof t.maxPerWallet&&(o.maxPerWallet=t.maxPerWallet),"number"==typeof t.maxPerTx&&(o.maxPerTx=t.maxPerTx),t.startsAt&&(o.startsAt=s.EK.fromDate(t.startsAt)),t.endsAt&&(o.endsAt=s.EK.fromDate(t.endsAt)),await (0,s.pl)(l,o),await (0,s.pl)(i,{addresses:t.addresses.map(e=>e.toLowerCase()),updatedAt:s.EK.now()})}static async deleteAllowlistRound(e,t){let a=(0,s.JU)(n.db,"collections",e);await (0,s.oe)((0,s.JU)((0,s.collection)(a,"allowlists"),t)),await (0,s.oe)((0,s.JU)((0,s.collection)(a,"allowlists"),"".concat(t,"-addresses")))}static async setCurrentAllowlist(e,t){await l.updateCollection(e,{currentAllowlistId:t})}static async getAllowlistAddresses(e,t){let a=(0,s.JU)(n.db,"collections",e),l=(0,s.JU)((0,s.collection)(a,"allowlists"),"".concat(t,"-addresses")),i=await (0,s.QT)(l);if(!i.exists())return[];let o=i.data();return Array.isArray(o.addresses)?o.addresses:[]}static async listAllowlistRounds(e){let t=(0,s.JU)(n.db,"collections",e),a=await (0,s.getDocs)((0,s.collection)(t,"allowlists")),l=[];return a.forEach(e=>{let t=e.data();t&&t.root&&t.id&&l.push(t)}),l}static async getAllowlistMeta(e,t){let a=(0,s.JU)(n.db,"collections",e),l=(0,s.JU)((0,s.collection)(a,"allowlists"),t),i=await (0,s.QT)(l);return i.exists()?i.data():null}static async getCollection(e){let t=(0,s.JU)(n.db,"collections",e),a=await (0,s.QT)(t);return a.exists()?{id:a.id,...a.data()}:null}static async deleteCollection(e){let t=(0,s.JU)(n.db,"collections",e);await (0,s.oe)(t)}static async updateCollectionDeployment(e,t){let a=(0,s.JU)(n.db,"collections",e);await (0,s.r7)(a,{deployment:t,status:"deployed",updatedAt:s.EK.now()})}static async updateCollectionStats(e,t){let a=(0,s.JU)(n.db,"collections",e);await (0,s.r7)(a,{stats:t,updatedAt:s.EK.now()})}}}}]);